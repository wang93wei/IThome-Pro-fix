# IThome Pro Fix

**版本**: 4.8.0
**更新日期**: 2026年1月20日

基于 [IThome Pro](https://greasyfork.org/zh-CN/scripts/504286-ithome-pro) 脚本进行的修复版。

## 修复内容

- 修复触发分页后，导致的页面卡死、图片加载不出来的问题

## 更新日志

### v4.8.0 (2026-01-20)
- 代码重构与优化，提升代码质量、性能和可维护性
  - 添加完整的JSDoc注释和行内注释，提升代码可读性
  - 修复重复添加style元素的bug，避免DOM污染
  - 优化MutationObserver处理逻辑，移除不必要的Promise包装
  - 为所有关键函数添加错误处理（try-catch），提升稳定性
  - 提取重复的图片加载代码为独立函数forceLoadImage
  - 定义CONFIG对象替换所有魔法数字，提升可配置性
  - 重构initializePage函数结构，提取子函数到模块级别
  - 优化选择器查询效率，合并部分选择器减少查询次数
  - 添加配置选项（showCommentBox、autoLoadMore、autoLoadImages等）
  - 将WeakSet/WeakMap改为Set/Map，避免元素被垃圾回收导致重复处理
  - 使用async/await优化异步操作
  - 使用Map和Set替代对象和数组
  - 封装可复用的debounce高阶函数
  - 统一使用Object.assign批量应用样式
  - 使用空值合并运算符(??)替代逻辑或运算符(||)
  - 使用箭头函数和const/let替代传统函数和var

### v4.7.3 (2026-01-14)
- 修复登录提示闪烁问题
  - 使用 CSS 在页面加载时直接隐藏登录提示
  - 防止登录提示在页面加载时短暂显示

### v4.7.2 (2026-01-14)
- 修复评论加载后登录提示未及时隐藏的问题

### v4.7.1 (2026-01-14)
- 优化防抖时间，避免触发网站频率限制
  - 滚动事件防抖：200ms → 500ms
  - DOM 变化防抖：100ms → 300ms
  - 标志位重置延迟：100ms → 200ms

### v4.7 (2026-01-14)
- 修复触发分页后，导致的页面卡死、图片加载不出来的问题